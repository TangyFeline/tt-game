@{
    Layout = "";
}

<!DOCTYPE html>

<html ng-app="fashionApp">
<head>
    <script src="~/Scripts/jquery-2.1.0.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min.js"></script>
    <script src="http://code.angularjs.org/1.2.20/angular-sanitize.min.js"></script>
<script src="~/Scripts/fwars/app.js"></script>
    <script src="~/Scripts/fwars/controllers/personsController.js"></script>
    <script src="~/Scripts/fwars/models/person.js"></script>
    <script src="~/Scripts/fwars/models/item.js"></script>
    <script src="~/Scripts/fwars/models/log.js"></script>
    <script src="~/Scripts/fwars/models/tfText.js"></script>
    <script src="~/Scripts/fwars/fwars.js"></script>


    <meta name="viewport" content="width=device-width" />
    <title>...</title>
</head>
<body ng-controllers="PersonsController">
    <h1>Fashion Wars</h1>

    <div data-ng-controller="PersonsController as ctrl">

        <p>{{timeOfDay}} Day {{day}} - {{money}} $ - {{infamy}} infamy</p>

        <div ng-show="startVisible">
            <p>What is your name?</p>
            <span> First name:  <input type="text" id="nameBoxFirst" ng-model="nameFirst" ng-init="nameFirst='Nina'" /></span>
            <span> Last name: <input type="text" id="nameBoxLast" ng-model="nameLast" ng-init="nameLast='Bryker'" /></span><br />
            <button ng-click="addPlayerAndStart(nameFirst, nameLast)">Found your Covenant!</button>
            <span>Name: {{nameFirst}}  {{nameLast}}</span>
        </div>

        <div ng-show="chooseBattlegroundView">
            <p>Where would you like to go to find new targets?</p>
            <button ng-click="chooseBattlegroundSend('park_forest_trail', 2)">Park:  Forest Trail</button>
            <button ng-click="chooseBattlegroundSend('park_parking_lot', 2)">Park:  Parking Lot</button>
            <button ng-click="chooseBattlegroundSend('park_lodge', 2)">Park:  Lodge</button>
            <button ng-click="chooseBattlegroundSend('coffeestore', 2)">Coffee Shop</button>
        </div>


        <div ng-show="fightView">

            <div class="container">
                <h3>Your members:</h3>
                <ul>
                    <li ng-repeat="person in personsPlayer.persons | orderBy:'firstName'">{{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}] [{{person.health}}/{{person.getMaxHP()}} HP]</li>
                </ul>
            </div>

            <div class="container">
                <h3>Opponents:</h3>
                <ul>
                    <li ng-repeat="person in personsAI.persons | orderBy:'firstName'">{{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}][{{person.health}}/{{person.getMaxHP()}} HP]</li>
                </ul>
            </div>


            <div class="container">
                <h3>Submissive Opponents:</h3>
                <ul>
                    <li ng-repeat="person in defeatedAI.persons | orderBy:'firstName'">{{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}][{{person.health}}/{{person.getMaxHP()}} HP]</li>
                </ul>
            </div>

            <div class="container">
                <h3>Submissive Allies:</h3>
                <ul>
                    <li ng-repeat="person in defeatedPlayer.persons | orderBy:'firstName'">{{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}][{{person.health}}/{{person.getMaxHP()}} HP]</li>
                </ul>
            </div>

            <div id="unequippedItems">
                <h3>New items from fight:</h3>
                <ul>
                    <li ng-repeat="item in newItems.items">{{item.type}} {{item.getVictimName()}}</li>
                </ul>
            </div>

            <button ng-click="startFight()" ng-show="startFightVisible">Begin Fight</button>
            <button ng-click="fight()" ng-show="continueFightVisible">Continue Fight (Round {{turnsSinceCombatStart}})</button>
            <button ng-click="retreat()" ng-show="retreatBtnVisible">Retreat!</button>
            <button ng-click="aftermath()" ng-show="aftermathBtn">View Fight Aftermath</button>
        </div>

        <div ng-show="aftermathView">
            <p>With the day over you can now take stock of your prisoners.  What shall you do with them?  Recruit them to your cause?  Or change them into cute little clothes for you, your friends, or the store next door?  You can also brainwash your opponents, leaving them with an altered body and mind so as to avoid increasing your infamy as high.  <b>You have {{energy}}/{{energyMax}}</b> energy left.  You have {{money}} dollars.</p>

            <button ng-show="aftermathViewLevelup_btn" ng-click="aftermathLevelupShow()">Release remaining {{defeatedAI.persons.length}} prisoners and continue</button>

            <div class="container">
                <h3>Submissive Opponents:</h3>
                <ul>
                    <li ng-repeat="person in defeatedAI.persons | orderBy:'firstName'">
                        {{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}]
                        <button ng-click="recruit(person)" ng-show="person.getRecruitmentCost() <= energy" class="recruit">Recruit ({{person.getRecruitmentCost()}} energy)</button>

                        <span ng-repeat="spell in leader.finishingSpells"><button ng-click="inanimate(person, spell)" ng-show="leader.getTransformCost(spell) <= energy && leader.itemIsSpell(spell)== true" class="inanimate">Turn into {{spell}} ({{leader.getTransformCost(spell)}} energy))</button></span>

                        <button ng-click="amnesia(person)" ng-show="energy > person.getBrainwashCost()" class="brainwash">Brainwash ({{person.getBrainwashCost()}} energy)</button>

                        <button ng-click="absorb(person)" ng-show="leader.getTransformCost('Absorb') <= energy && leader.knowsAbsorb()==true" class="absorb">Absorb ({{leader.getTransformCost('Absorb')}} energy)</button>

                    </li>
                </ul>
            </div>

            <div id="unequippedItems">
                <h3>New items from fight:</h3>
                <ul>
                    <li ng-repeat="item in newItems.items">{{item.type}} {{item.getVictimName()}}</li>
                </ul>
            </div>

            <div id="unequippedItems">
                <h3>Unequipped items:</h3>
                <ul>
                    <li ng-repeat="item in unequippedItems.items">{{item.type}} {{item.getVictimName()}}</li>
                </ul>
            </div>

        </div>

        <div ng-show="aftermathViewLevelup">
            <p>Level up and train your members...</p>

            <div class="container">
                <h3>Members:</h3>
                <ul>
                    <li ng-repeat="person in personsPlayer.persons | orderBy:'firstName'">
                        {{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}][{{person.health}}/{{person.getMaxHP()}} HP] [{{person.xp}}/{{person.xpNeededForLevelup()}} XP before levelup]

                        <button ng-click="promote(person,'Witchling')" ng-show="person.xp >= person.xpNeededForLevelup() && (person.type == 'Female Bystander' || person.type == 'Male Bystander')">Transform into Witchling</button>


                    </li>
                </ul>
            </div>

            <button ng-show="endDay_btn" ng-click="endDay()">End day</button>

        </div>

        <div ng-show="buySellItemsView">
            <p>It's another bright day and your soul item dealer is stopping by.  You can sell your inanimate victims or purchase some new powerful items for them if you wish.  You have {{money}} dollars.</p>

            <div id="unequippedItems">
                <h3>Your inventory:</h3>
                <ul>
                    <li ng-repeat="item in unequippedItems.items">
                        {{item.type}} {{item.getVictimName()}}
                        <button ng-show="sellItem_btn" ng-click="sellItem(item)">Sell for {{item.getSellPrice()}} $</button>
                    </li>
                </ul>
            </div>

            <div>
                <h3>Purchase:</h3>
                <ul>
                    <li ng-repeat="item in itemsMap">
                        {{item.name}} ({{item.value}} dollars)
                        <button ng-show="item.isPurchaseableItem == true && money >= item.value" ng-click="buyItem(item.name)">Buy</button>
                    </li>
                </ul>
            </div>

            <button ng-show="equipView_btn" ng-click="showEquipMembersView()">Equip Members</button>

        </div>


        <div ng-show="assignItemsView">
            <h3>Equip your Members</h3>

            <div id="unequippedItems">
                <h3>Unequipped items:</h3>
                <ul>
                    <li ng-repeat="item in unequippedItems.items">
                        {{item.type}} {{item.getVictimName()}}
                        <span ng-show="item.id == currentlySelectedItem.id">CURRENT</span>
                    </li>
                </ul>
            </div>

            <div ng-show="unequippedItems.items.length > 0">
                <span>Currently assigning {{currentlySelectedItem.type}} {{item.getVictimName()}}</span>

                <button ng-click="equipPrevious()" ng-show="unequippedItems.items.length > 0">Previous</button>
                <button ng-click="equipNext()" ng-show="unequippedItems.items.length > 0">Next</button>

            </div>

            <div class="container">
                <h3>Members:</h3>
                <ul>
                    <li ng-repeat="person in personsPlayer.persons | orderBy:'firstName'">
                        {{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}][{{person.health}}/{{person.getMaxHP()}} HP] [{{person.items.length}} items equipped]

                        Wearing:  <span ng-repeat="item in person.items"><b>{{item.type}}</b>, </span>

                        <button ng-click="assignTo(person, currentlySelectedItem)" ng-show="person.items.length < 2 && unequippedItems.items.length > 0" class="assign">Assign To Me</button>
                        <button ng-click="strip(person)" ng-show="person.items.length > 0" class="remove">Remove All Items</button>


                    </li>
                </ul>
            </div>


            <button ng-show="teachSpells_btn" ng-click="showTeachSpells()">Teach Spells</button>

        </div>

        <div ng-show="teachSpellsView">
            <h3>Teach new Spells to Members</h3>

            <p>You may teach your covenant members some new spells to cast against their defeated opponents right in battle.</p>

            <ul>
                <li ng-repeat="person in personsPlayer.persons | orderBy:'firstName'">
                    {{person.firstName}} {{person.lastName}} [lvl {{person.level}} {{person.type}}]
                    Knows: <span ng-repeat="spell in person.finishingSpells"> <b>{{spell}}</b>,</span>
                    <span ng-show="person.id == currentlySelectedPerson.id">CURRENT</span>
                </li>
            </ul>

            <button ng-click="teachPrevious()" ng-show="personsPlayer.persons.length > 0">Previous</button>
            <button ng-click="teachNext()" ng-show="personsPlayer.persons.length > 0">Next</button>

            <p>Teaching {{currentlySelectedPerson.fullName()}}...</p>

            <li ng-repeat="item in itemsMap">
                {{item.name}} ({{item.spellTrainingCost}} dollars)
                <button ng-show="money >= item.spellTrainingCost && currentlySelectedPerson.knowsSpell(item.name) == false" ng-click="teachSpell(item.name)" class="assign">Train</button>
                <span ng-show="currentlySelectedPerson.knowsSpell(item.name) == true">(Already known)</span>
            </li>

            <button ng-show="newfight_btn" ng-click="chooseBattleground()">Choose Battleground</button>

        </div>

        <div id="log">
            <p ng-repeat="log in logs">
                <span ng-bind-html="log.message"></span>
            </p>
        </div>


    </div>
</body>



</html>

<style>
    #log {
        height: 300px;
        border: 1px solid black;
        width: 100%;
        overflow: scroll;
    }

    #id li {
        margin-top: 5px;
        margin-bottom: 5px;
    }

    .remove {
        background-color:lightpink;
    }

    .assign {
        background-color: lightgreen;
    }

    .inanimate {
        background-color: lightyellow;
    }

    .recruit {
        background-color: lightblue;
    }

    .brainwash {
        background-color: orange;
    }

    .absorb {
        background-color: lightseagreen;
    }


    .newcov {
        color: darkgreen;
        font-weight: bolder;
    }

    .fight {
        color: red;
        font-weight: bolder;
    }

    .inanimated {
        color: darkviolet;
        font-weight: bolder;
    }

    .submit {
        color: indianred;
        font-weight: bolder;
    }

</style>