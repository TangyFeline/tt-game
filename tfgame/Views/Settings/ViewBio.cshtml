@model tfgame.dbModels.Models.PlayerBio
@using tfgame.CustomHtmlHelpers
@using tfgame.ViewModels

<nav class="navbar navbar-default outsideContainer navbarTT2">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">
            <ul class="nav navbar-nav">
                <li>@Html.ActionLink("Back to game", "Play", "PvP")</li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<div class="containerInner">
    <h1>Player Bio for @ViewBag.Name</h1>

    @{
        if (Model.WebsiteURL != "")
        {
            <h3>Website</h3>

            @*<p>@CharactersHere.StringToWebsite(Model.WebsiteURL)</p>*@

            <p>@Model.WebsiteURL</p>
        }
    }


    <h3>Bio</h3>

    @{
        if (Model.Text != null && Model.Text != "")
        {
            <p>@Html.Raw(Model.Text.Replace("[br]", "<br/>"))</p>
        }
    }


    <h3>RP Tags</h3>

    @Html.HiddenFor(m => m.Tags)

    @Html.Partial("partial/rptags")

    <p class="timeago">Last updated @Model.Timestamp</p><br />

    @{
        if (ViewBag.MyContributions.Count > 0)
        {
            foreach (BioPageContributionViewModel s in ViewBag.MyContributions)
            {
                <p>Author of the <b>@s.SpellName</b> spell which transforms its victim into the <b>@s.FormName</b> form.</p>
            }
        }

        if (ViewBag.MyEffectContributions.Count > 0)
        {
            foreach (BioPageEffectContributionViewModel s in ViewBag.MyEffectContributions)
            {
                if (s.SpellName != null && s.EffectName != "")
                {
                    <p>Author of the <b>@s.EffectName</b> effect cast which is gained by being struck with the <b>@s.SpellName</b> spell.</p>
                }
                else
                {
                    <p>Author of the <b>@s.EffectName</b> effect.</p>
                }

            }
        }

    }
</div>

    <script>


        $(document).ready(function () {

            var tagstring = $("#Tags").val();
            console.log("Raw string:  " + tagstring);

            // assign the proper styling onload
            $(".rpTag").each(function () {

                var code = $(this).attr("tagcode");
                var regexs = ";" + code + ".[0-9];";
                var regex = new RegExp(regexs, "i")
                var smatch = tagstring.match(regex);

                // currently exists; increment its state
                if (smatch !== null) {
                    console.log("Match found:  " + smatch);
                    var numberValue = smatch[0].match(/[0-9]/);
                    console.log("Value of match:  " + numberValue);

                    if (numberValue == 0) {
                        $(this).addClass("neg2");
                    } else if (numberValue == 1) {
                        $(this).addClass("neg1");
                    } else if (numberValue == 2) {
                        $(this).addClass("pos1");
                    } else if (numberValue == 3) {
                        $(this).addClass("pos2");
                    }
                }
            });

        });

    </script>
