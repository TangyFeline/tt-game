@model IEnumerable<tfgame.dbModels.Models.ChatLog>
@using tfgame.dbModels.Models

<nav class="navbar navbar-default outsideContainer navbarTT2">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-2">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-2">
            <ul class="nav navbar-nav">
                <li>@Html.ActionLink("Back to game", "Play", "PvP")</li>
                <li>
                    @Html.ActionLink("Global", "Index", "Chat", new { room = "global" }, null)
                </li>
                <li>
                    @Html.ActionLink("RP Room 1", "Index", "Chat", new { room = "rp1" }, null)
                </li>
                <li>
                    @Html.ActionLink("RP Room 2", "Index", "Chat", new { room = "rp2" }, null)
                </li>
                <li>@Html.ActionLink("RP Room 3", "Index", "Chat", new { room = "rp3" }, null)</li>
                <li>
                    @Html.ActionLink("Create/Join Private Room", "PrivateChat", "PvP")
                </li>
                <li>@Html.ActionLink("Commands", "ChatCommands", "PvP", null, new { target = "_blank" })</li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<nav class="navbar navbar-default outsideContainer navbarTT2">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-3">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-3">
            <ul class="nav navbar-nav">
                <li>@Html.ActionLink("Last Hour", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "lasth" }, null)</li>
                <li>
                    @Html.ActionLink("Last 4 Hours", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "last4h" }, null)
                </li>
                <li>
                    @Html.ActionLink("Last 12 Hours", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "last12h" }, null)
                </li>
                <li>
                    @Html.ActionLink("Last Day", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "last24h" }, null)
                </li>
                <li>
                    @Html.ActionLink("Last 2 Days", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "last48h" }, null)
                </li>
                <li>@Html.ActionLink("Last 3 Days", "ChatLog", "PvP", new { room = ViewBag.Room, filter = "last72h" }, null)</li>
</ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<div class="containerInner">
    <h2>Chat Log for Room '@ViewBag.Room'</h2>
    <p>Note that <b>oldest posts are on top</b>, not newest.  You can use the links before to change the filter time; longer durations will take longer to load.  Please be patient and use the longer filters sparingly.  Any chat messages older than 3 days are eligible for permanent deletion.</p>
    <p>Chat log for private room:</p>

    <form>
        Room name:<br>
        <input type="text" id="roomName">
        <button name="subject" type="button" id="beginButton">View Logs</button>
    </form>

    <ul id="discussion">

        @{
            foreach (ChatLog l in Model)
            {
                @*<li>@l.Message <span class="timeago">@l.Timestamp</span></li>*@
                <li>@l.Message</li>
            }
        }

    </ul>
</div>
    <script>

        function getParameterByName(name) {
            name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        $(document).ready(function () {

            $("#beginButton").click(function () {
                window.location = "/PvP/ChatLog?room=" + $("#roomName").val() + "&filter=" + getParameterByName('filter');
            });

            $("li").each(function () {
                var encodedValue = $(this).html();
                encodedValue = encodedValue.replace("[.[", "<span class='timeago'>");
                encodedValue = encodedValue.replace("].]", "</span>");
                encodedValue = encodedValue.replace("[-[", "<span class='enterMsg'>");
                encodedValue = encodedValue.replace("]-]", "</span>");
                encodedValue = encodedValue.replace("[=[", "<span class='dm'>");
                encodedValue = encodedValue.replace("]=]", "</span>");
                encodedValue = encodedValue.replace("[+[", "<span class='me'>");
                encodedValue = encodedValue.replace("]+]", "</span>");
                encodedValue = encodedValue.replace("Judoo (admin)", "<span class='adminFont'>Judoo (admin)</span>");
                encodedValue = encodedValue.replace("Mizuho (dev)", "<span class='adminFont'>Mizuho (dev)</span>");
                $(this).html(encodedValue);
            });

        });

</script>