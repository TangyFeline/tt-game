@model IEnumerable<TT.Domain.Models.NewsPost>
    @using TT.Domain.Models

<div>
    <p class="infoMessage result">@Html.Raw(ViewBag.Result)</p>
    <p class="infoMessage error">@ViewBag.ErrorMessage</p>
    <p class="infoMessage suberror">@ViewBag.SubErrorMessage</p>
</div>


@Html.ActionLink("Back","Index","PvPAdmin")

<h2>ListNewsPosts</h2>

<table id="newsPosts" class="table table-hover messageTable">
    <thead>
        <tr>
            <th>Id</th>
            <th>Timestamp</th>
            <th>Text</th>
            <th>Visibility</th>
            <th>Edit</th>
            <th>Delete</th>
        </tr>
    </thead>
    <tbody>

        @{
            foreach (NewsPost n in Model)
            {
                <tr>
                    <td>@n.Id</td>
                    <td>@n.Timestamp</td>
                    <td>@Html.Raw(n.Text)</td>
                    <td>@n.PrintVisiblity()</td>
                    <td>@Html.ActionLink("Edit", "EditNewsPost", "PvPAdmin", new { Id = n.Id }, null)</td>
                    <td>@Html.ActionLink("[X]", "DeleteNewsPost", "PvPAdmin", new { Id = n.Id }, new { onclick = "return confirm('Are you sure you want to delete this?')", @class = "" })</td>
                </tr>
            }
        }

    </tbody>

</table>

@Html.ActionLink("New", "EditNewsPost", "PvPAdmin", new { Id = -1 }, null)

<script>
    $(document).ready(function () {
        $('#newsPosts').dataTable({
            "order": [[1, "desc"]],
            "columnDefs": [{
                "targets": 1,
                "render": function (data, type, full, meta) {
                    if (type == "display") return moment(data).fromNow();
                    return data;
                }
            }]
        });
    });
</script>